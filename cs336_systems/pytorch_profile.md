--------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                            Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  
--------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                                   ProfilerStep*        40.02%     166.720ms        71.85%     299.280ms      99.760ms       0.000us         0.00%      16.436ms       5.479ms           0 b        -288 b           0 b    -899.59 Mb             3  
                                                                      BLOCK_ATTN        11.71%      48.764ms        23.22%      96.738ms       2.687ms       0.000us         0.00%       6.814ms     189.286us         288 b         288 b     124.95 Mb    -229.78 Mb            36  
                                                                cudaLaunchKernel         7.47%      31.106ms         7.47%      31.106ms       5.218us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          5961  
                                                                    aten::einsum         1.41%       5.877ms         7.02%      29.227ms      89.378us       0.000us         0.00%      11.081ms      33.888us           0 b           0 b     306.12 Mb           0 b           327  
                                                                       aten::bmm         4.45%      18.534ms         6.58%      27.393ms      27.924us      31.762ms        53.96%      31.762ms      32.377us           0 b           0 b       2.21 Gb       2.21 Gb           981  
                               autograd::engine::evaluate_function: BmmBackward0         0.61%       2.561ms         5.18%      21.593ms      66.035us       0.000us         0.00%      20.681ms      63.244us           0 b           0 b       1.48 Gb    -442.24 Mb           327  
                                                                       aten::mul         3.32%      13.831ms         5.11%      21.280ms      13.136us       4.685ms         7.96%       4.685ms       2.892us          16 b          16 b     834.19 Mb     834.19 Mb          1620  
                                                                    BmmBackward0         0.46%       1.936ms         4.57%      19.032ms      58.202us       0.000us         0.00%      20.681ms      63.244us           0 b           0 b       1.92 Gb           0 b           327  
                               autograd::engine::evaluate_function: MulBackward0         1.03%       4.300ms         4.40%      18.340ms      35.961us       0.000us         0.00%       3.674ms       7.204us           0 b           0 b    -136.62 Mb    -555.38 Mb           510  
                                                                       BLOCK_FFN         1.26%       5.246ms         4.10%      17.064ms     473.992us       0.000us         0.00%       5.796ms     161.006us           0 b           0 b     321.00 Mb           0 b            36  
                                                                   aten::reshape         1.12%       4.672ms         3.45%      14.353ms       4.709us       0.000us         0.00%     514.024us       0.169us           0 b           0 b      81.00 Mb           0 b          3048  
                           autograd::engine::evaluate_function: PermuteBackward0         1.59%       6.608ms         3.14%      13.093ms       7.074us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1851  
                                                                   aten::permute         2.01%       8.381ms         2.48%      10.316ms       2.682us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          3846  
                                                                    MulBackward0         0.30%       1.245ms         2.39%       9.967ms      19.542us       0.000us         0.00%       2.442ms       4.788us           0 b           0 b     418.50 Mb           0 b           510  
                              autograd::engine::evaluate_function: ViewBackward0         0.98%       4.083ms         2.34%       9.741ms       8.391us       0.000us         0.00%     265.797us       0.229us           0 b           0 b           0 b     -40.50 Mb          1161  
            autograd::engine::evaluate_function: torch::autograd::AccumulateGrad         0.25%       1.059ms         1.92%       7.978ms      23.959us       0.000us         0.00%      10.091ms      30.303us           0 b           0 b    -384.00 Kb    -358.00 Mb           333  
                         autograd::engine::evaluate_function: UnsqueezeBackward0         0.86%       3.567ms         1.91%       7.958ms       8.755us       0.000us         0.00%     312.839us       0.344us           0 b           0 b     -40.50 Mb     -67.50 Mb           909  
                                                                     aten::index         0.72%       2.988ms         1.83%       7.635ms      51.941us     304.384us         0.52%     591.295us       4.022us           0 b           0 b       5.62 Mb       3.38 Mb           147  
                                                                     aten::copy_         0.94%       3.916ms         1.80%       7.519ms      13.695us      11.847ms        20.12%      11.847ms      21.579us           0 b           0 b           0 b           0 b           549  
                                                 torch::autograd::AccumulateGrad         0.31%       1.283ms         1.66%       6.919ms      20.778us       0.000us         0.00%      10.091ms      30.303us           0 b           0 b     357.62 Mb      -1.36 Gb           333  
                                                                       BLOCK_LN2         0.72%       3.011ms         1.60%       6.674ms     185.399us       0.000us         0.00%     504.263us      14.007us           0 b           0 b      27.02 Mb     -13.54 Mb            36  
                                                                       BLOCK_LN1         0.71%       2.952ms         1.59%       6.644ms     184.556us       0.000us         0.00%     495.303us      13.758us           0 b           0 b      27.02 Mb     -13.54 Mb            36  
                                                                PermuteBackward0         0.47%       1.951ms         1.56%       6.485ms       3.503us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          1851  
                      autograd::engine::evaluate_function: ReshapeAliasBackward0         0.49%       2.043ms         1.38%       5.761ms      10.610us       0.000us         0.00%     162.913us       0.300us           0 b           0 b           0 b     -27.00 Mb           543  
                                                                   ViewBackward0         0.26%       1.080ms         1.36%       5.659ms       4.874us       0.000us         0.00%     265.797us       0.229us           0 b           0 b      40.50 Mb           0 b          1161  
                               autograd::engine::evaluate_function: PowBackward0         0.20%     838.552us         1.30%       5.416ms      72.216us       0.000us         0.00%     532.066us       7.094us           0 b           0 b     -56.25 Mb     -84.75 Mb            75  
                                                                       aten::cat         0.72%       2.987ms         1.18%       4.906ms      34.070us     613.892us         1.04%     613.892us       4.263us           0 b           0 b      54.00 Mb      54.00 Mb           144  
                                                                      aten::view         1.16%       4.847ms         1.16%       4.847ms       1.708us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          2838  
                                                                       aten::pow         0.64%       2.645ms         1.16%       4.831ms      21.473us     231.416us         0.39%     357.145us       1.587us           0 b           0 b      56.29 Mb      56.29 Mb           225  
                                                                       aten::add         0.76%       3.172ms         1.14%       4.751ms      16.328us     598.793us         1.02%     598.793us       2.058us           0 b           0 b      67.54 Mb      67.54 Mb           291  
                                                                       aten::div         0.76%       3.185ms         1.14%       4.735ms      15.943us     799.503us         1.36%     799.503us       2.692us           0 b           0 b     190.13 Mb     190.13 Mb           297  
                                                                     aten::where         0.28%       1.148ms         1.13%       4.697ms      32.621us     236.320us         0.40%     554.465us       3.850us           0 b           0 b     108.00 Mb     -33.50 Kb           144  
                                                                     aten::clone         0.13%     552.553us         1.02%       4.245ms      19.654us       0.000us         0.00%     514.024us       2.380us           0 b           0 b      81.00 Mb           0 b           216  
                                                                      aten::add_         0.54%       2.251ms         0.98%       4.102ms       9.302us       1.481ms         2.52%       1.481ms       3.359us           0 b           0 b           0 b           0 b           441  
                               autograd::engine::evaluate_function: DivBackward0         0.14%     566.557us         0.98%       4.098ms      56.910us       0.000us         0.00%     778.825us      10.817us        -288 b        -288 b           0 b     -81.21 Mb            72  
                             autograd::engine::evaluate_function: RsqrtBackward0         0.10%     413.217us         0.96%       3.994ms      53.254us       0.000us         0.00%     294.904us       3.932us           0 b           0 b     -37.50 Kb     -75.50 Kb            75  
                                                                       aten::sum         0.66%       2.740ms         0.96%       3.980ms      14.908us       1.609ms         2.73%       1.609ms       6.024us           0 b           0 b     915.00 Kb     915.00 Kb           267  
                                                                    PowBackward0         0.09%     388.786us         0.94%       3.901ms      52.014us       0.000us         0.00%     391.237us       5.216us           0 b          -8 b      28.50 Mb     -55.88 Mb            75  
                                                               aten::concatenate         0.02%     100.703us         0.94%       3.901ms      54.177us       0.000us         0.00%     345.761us       4.802us           0 b           0 b      27.00 Mb           0 b            72  
                                                                aten::as_strided         0.92%       3.836ms         0.92%       3.836ms       0.534us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b          7188  
                                                           ReshapeAliasBackward0         0.13%     552.314us         0.89%       3.718ms       6.848us       0.000us         0.00%     162.913us       0.300us           0 b           0 b      27.00 Mb           0 b           543  
                                                                  RsqrtBackward0         0.11%     462.240us         0.86%       3.581ms      47.744us       0.000us         0.00%     294.904us       3.932us           0 b           0 b      38.00 Kb     -74.50 Kb            75  
                                                                 aten::unsqueeze         0.60%       2.479ms         0.72%       3.012ms       3.303us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           912  
                               autograd::engine::evaluate_function: SubBackward0         0.15%     632.835us         0.72%       3.000ms      26.317us       0.000us         0.00%     951.241us       8.344us           0 b           0 b      13.71 Mb    -174.24 Mb           114  
                                                                    DivBackward0         0.09%     386.947us         0.72%       2.998ms      41.640us       0.000us         0.00%     627.306us       8.713us           0 b           0 b      81.00 Mb     -81.00 Mb            72  
                                                              UnsqueezeBackward0         0.22%     924.751us         0.71%       2.972ms       3.269us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           909  
                               autograd::engine::evaluate_function: MaxBackward0         0.11%     445.190us         0.67%       2.800ms      71.804us       0.000us         0.00%     664.580us      17.041us           0 b           0 b    -652.50 Kb    -101.26 Mb            39  
                                                                    aten::arange         0.15%     634.214us         0.66%       2.755ms      18.368us      87.998us         0.15%     175.996us       1.173us           0 b           0 b     150.00 Kb           0 b           150  
                              autograd::engine::evaluate_function: MeanBackward1         0.08%     349.996us         0.53%       2.192ms      29.224us       0.000us         0.00%     163.623us       2.182us           0 b           0 b      28.09 Mb     -37.50 Kb            75  
                                                                   aten::squeeze         0.41%       1.718ms         0.49%       2.047ms       2.252us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b           909  
--------------------------------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 416.553ms
Self CUDA time total: 58.866ms
